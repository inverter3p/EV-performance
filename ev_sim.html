<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>EV Performance & Range Simulator</title>
    <!-- External Dependencies -->
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <!-- Link to your new CSS file -->
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <!-- All the original body content remains exactly the same -->
    <div class="container">
      <aside class="sidebar">
        <!-- ... (all the form and sidebar content) ... -->
        <form id="ev-form">
          <div class="form-group">
            <label for="model-select">Select Vehicle Model</label>
            <select id="model-select">
              <option value="custom">Custom Model</option>
              <option value="tesla_model_3_lr">
                Tesla Model 3 Highland (RWD)
              </option>
              <option value="bmw_i4_edrive40">BMW i4 (eDrive40)</option>
              <option value="porsche_taycan_rwd">Porsche Taycan (RWD)</option>
              <option value="tesla_model_y_lr">Tesla Model Y (LR)</option>
              <option value="bmw_ix_xdrive50">BMW iX (xDrive50)</option>
            </select>
          </div>

          <div class="heading-with-help">
            <h2>Vehicle Parameters</h2>
            <button type="button" id="help-btn" title="Open Help Guide">?</button>
          </div>
          <div class="form-group">
            <label for="mass">Vehicle Mass (kg)</label
            ><input type="number" id="mass" value="1750" min="500" step="1" />
          </div>
          <div class="form-group">
            <label for="cd">Drag Coefficient (Cd)</label
            ><input
              type="number"
              id="cd"
              value="0.29"
              min="0.15"
              max="0.5"
              step="0.01"
            />
          </div>
          <div class="form-group">
            <label for="frontal-area">Frontal Area (mÂ²)</label
            ><input
              type="number"
              id="frontal-area"
              value="2.4"
              min="1.5"
              max="4.0"
              step="0.01"
            />
          </div>
          <div class="form-group">
            <label for="wheel-radius">Wheel Radius (m)</label
            ><input
              type="number"
              id="wheel-radius"
              value="0.34"
              min="0.25"
              max="0.5"
              step="0.001"
            />
          </div>
          <div class="form-group">
            <label for="crr">Rolling Resistance Coeff. (Crr)</label
            ><input
              type="number"
              id="crr"
              value="0.009"
              min="0.005"
              max="0.02"
              step="0.001"
            />
          </div>
          <div class="form-group">
            <label for="gear-ratio">Gear Ratio</label
            ><input
              type="number"
              id="gear-ratio"
              value="9.1"
              min="5.0"
              max="15.0"
              step="0.01"
            />
          </div>

          <div id="param-group-perf" class="hidden">
            <h2>Performance Analysis Parameters</h2>
            <div class="form-group">
              <label for="max-torque">Max Motor Torque (Nm)</label
              ><input
                type="number"
                id="max-torque"
                value="310"
                min="50"
                step="1"
              />
            </div>
            <div class="form-group">
              <label for="max-power">Max Motor Power (kW)</label
              ><input type="number" id="max-power" value="150" min="20" step="1" />
            </div>
            <div class="form-group">
              <label for="efficiency">Drivetrain Efficiency (%):</label
              ><input type="number" id="efficiency" step="1" value="90" />
            </div>
            <div class="form-group">
              <label for="mass-factor">Rotational Mass Factor (%)</label
              ><input
                type="number"
                id="mass-factor"
                value="5"
                min="0"
                max="15"
                step="1"
              />
            </div>
          </div>

          <div id="param-group-range">
            <h2>Range Simulation Parameters</h2>
            <div class="form-group">
              <label for="drivetrain-eff">Drivetrain Efficiency (%)</label>
              <div class="slider-group">
                <input
                  type="number"
                  id="drivetrain-eff"
                  step="1"
                  value="90"
                  min="80"
                  max="98"
                />
              </div>
            </div>
            <div class="form-group">
              <label for="motor-eff">Motor & Inverter Efficiency (%)</label>
              <div class="slider-group">
                <input
                  type="number"
                  id="motor-eff"
                  step="1"
                  value="90"
                  min="80"
                  max="98"
                />
              </div>
            </div>
            <div class="form-group">
              <label for="battery-capacity">Battery Capacity (kWh)</label>
              <div class="slider-group">
                <input
                  type="range"
                  id="battery-capacity"
                  value="60.5"
                  min="10"
                  max="200"
                  step="0.1"
                /><span id="battery-capacity-value" data-unit=" kWh">60.5 kWh</span>
              </div>
            </div>
            <div class="form-group">
              <label for="max-regen-c-rate">Max Regen Rate (C-rate)</label
              ><input
                type="number"
                id="max-regen-c-rate"
                value="2"
                min="0.1"
                max="5"
                step="0.01"
              />
            </div>
            <div class="form-group">
              <label for="regen-strategy">Select Strategy</label
              ><select id="regen-strategy">
                <option value="none">No Regeneration</option>
                <option value="simple" selected>Simple (Fixed %)</option>
                <option value="rule-based">Rule-Based</option>
              </select>
            </div>
            <div class="form-group" id="configure-rules-container">
              <button
                type="button"
                class="btn secondary"
                id="configure-rules-btn"
              >
                Configure Strategy
              </button>
            </div>
          </div>

          <button type="submit" class="btn" id="run-range-btn">
            Run Range Simulation
          </button>
          <button type="submit" class="btn hidden" id="run-perf-btn">
            Run Performance Simulation
          </button>
        </form>
      </aside>

      <main class="main-content">
        <!-- ... (all the main content and modal HTML) ... -->
        <!-- ... This section is large, so it's omitted for brevity ... -->
        <!-- ... but you should copy the entire <main> and modal <div>s here ... -->
      </main>
    </div>

    <div id="rules-modal" class="modal"><!-- ... (modal content) ... --></div>
    <div id="help-modal" class="modal"><!-- ... (modal content) ... --></div>

    <!-- Link to your new JavaScript file, placed at the end of the body -->
    <script src="script.js"></script>
  </body>
</html>
